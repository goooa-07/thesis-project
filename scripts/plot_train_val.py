import re
import matplotlib.pyplot as plt
from pathlib import Path

log_text = """
Train 1/60: 100%|███████████████████████████████████████| 249/249 [00:32<00:00, 7.60it/s] Epoch 01: lr=0.000400 train_loss=1.7298 train_acc=0.4773 val_acc=0.6667 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.6667) Train 2/60: 100%|███████████████████████████████████████| 249/249 [00:32<00:00, 7.66it/s] Epoch 02: lr=0.000400 train_loss=0.8582 train_acc=0.7297 val_acc=0.7966 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.7966) Train 3/60: 100%|███████████████████████████████████████| 249/249 [00:33<00:00, 7.44it/s] Epoch 03: lr=0.000400 train_loss=0.6369 train_acc=0.7935 val_acc=0.8761 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.8761) Train 4/60: 100%|███████████████████████████████████████| 249/249 [00:33<00:00, 7.34it/s] Epoch 04: lr=0.000400 train_loss=0.4409 train_acc=0.8584 val_acc=0.9194 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.9194) Train 5/60: 100%|███████████████████████████████████████| 249/249 [00:34<00:00, 7.13it/s] Epoch 05: lr=0.000400 train_loss=0.3696 train_acc=0.8761 val_acc=0.9174 Train 6/60: 100%|███████████████████████████████████████| 249/249 [00:32<00:00, 7.63it/s] Epoch 06: lr=0.000400 train_loss=0.3300 train_acc=0.8868 val_acc=0.9275 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.9275) Train 7/60: 100%|███████████████████████████████████████| 249/249 [00:32<00:00, 7.60it/s] Epoch 07: lr=0.000400 train_loss=0.2866 train_acc=0.9067 val_acc=0.9416 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.9416) Train 8/60: 100%|███████████████████████████████████████| 249/249 [00:32<00:00, 7.64it/s] Epoch 08: lr=0.000400 train_loss=0.2500 train_acc=0.9174 val_acc=0.9486 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.9486) Train 9/60: 100%|███████████████████████████████████████| 249/249 [00:33<00:00, 7.44it/s] Epoch 09: lr=0.000400 train_loss=0.2205 train_acc=0.9291 val_acc=0.9587 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.9587) Train 10/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.22it/s] Epoch 10: lr=0.000400 train_loss=0.1873 train_acc=0.9379 val_acc=0.9587 Train 11/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.54it/s] Epoch 11: lr=0.000400 train_loss=0.1767 train_acc=0.9394 val_acc=0.9255 Train 12/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.41it/s] Epoch 12: lr=0.000400 train_loss=0.1643 train_acc=0.9426 val_acc=0.9486 Train 13/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.72it/s] Epoch 13: lr=0.000400 train_loss=0.1696 train_acc=0.9455 val_acc=0.9557 Train 14/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.72it/s] Epoch 14: lr=0.000400 train_loss=0.1125 train_acc=0.9647 val_acc=0.9557 Train 15/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.72it/s] Epoch 15: lr=0.000400 train_loss=0.1365 train_acc=0.9542 val_acc=0.9789 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.9789) Train 16/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.73it/s] Epoch 16: lr=0.000400 train_loss=0.1167 train_acc=0.9634 val_acc=0.9456 Train 17/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.73it/s] Epoch 17: lr=0.000400 train_loss=0.1162 train_acc=0.9626 val_acc=0.9829 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.9829) Train 18/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.72it/s] Epoch 18: lr=0.000400 train_loss=0.1049 train_acc=0.9668 val_acc=0.9789 Train 19/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.72it/s] Epoch 19: lr=0.000400 train_loss=0.1039 train_acc=0.9652 val_acc=0.9668 Train 20/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.70it/s] Epoch 20: lr=0.000400 train_loss=0.1064 train_acc=0.9679 val_acc=0.9768 Train 21/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.63it/s] Epoch 21: lr=0.000040 train_loss=0.0612 train_acc=0.9819 val_acc=0.9930 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.9930) Train 22/60: 100%|██████████████████████████████████████| 249/249 [14:37<00:00, 3.52s/it] Epoch 22: lr=0.000040 train_loss=0.0432 train_acc=0.9891 val_acc=0.9899 Train 23/60: 100%|██████████████████████████████████████| 249/249 [00:30<00:00, 8.05it/s] Epoch 23: lr=0.000040 train_loss=0.0440 train_acc=0.9883 val_acc=0.9940 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.9940) Train 24/60: 100%|██████████████████████████████████████| 249/249 [00:31<00:00, 7.99it/s] Epoch 24: lr=0.000040 train_loss=0.0401 train_acc=0.9884 val_acc=0.9930 Train 25/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.73it/s] Epoch 25: lr=0.000040 train_loss=0.0359 train_acc=0.9894 val_acc=0.9919 Train 26/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.77it/s] Epoch 26: lr=0.000040 train_loss=0.0375 train_acc=0.9896 val_acc=0.9899 Train 27/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.73it/s] Epoch 27: lr=0.000040 train_loss=0.0339 train_acc=0.9911 val_acc=0.9940 Train 28/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.77it/s] Epoch 28: lr=0.000040 train_loss=0.0305 train_acc=0.9920 val_acc=0.9930 Train 29/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.46it/s] Epoch 29: lr=0.000040 train_loss=0.0322 train_acc=0.9903 val_acc=0.9909 Train 30/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.39it/s] Epoch 30: lr=0.000040 train_loss=0.0312 train_acc=0.9903 val_acc=0.9930 Train 31/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.35it/s] Epoch 31: lr=0.000040 train_loss=0.0339 train_acc=0.9898 val_acc=0.9940 Train 32/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.34it/s] Epoch 32: lr=0.000040 train_loss=0.0308 train_acc=0.9920 val_acc=0.9950 ✅ Saved best checkpoint: checkpoints\best_stgcn.pt (val_acc=0.9950) Train 33/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.27it/s] Epoch 33: lr=0.000040 train_loss=0.0273 train_acc=0.9925 val_acc=0.9950 Train 34/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.26it/s] Epoch 34: lr=0.000040 train_loss=0.0289 train_acc=0.9916 val_acc=0.9940 Train 35/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.23it/s] Epoch 35: lr=0.000040 train_loss=0.0264 train_acc=0.9928 val_acc=0.9919 Train 36/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.23it/s] Epoch 36: lr=0.000040 train_loss=0.0276 train_acc=0.9923 val_acc=0.9940 Train 37/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.19it/s] Epoch 37: lr=0.000040 train_loss=0.0238 train_acc=0.9932 val_acc=0.9930 Train 38/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.21it/s] Epoch 38: lr=0.000040 train_loss=0.0291 train_acc=0.9916 val_acc=0.9940 Train 39/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.18it/s] Epoch 39: lr=0.000040 train_loss=0.0275 train_acc=0.9918 val_acc=0.9940 Train 40/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.31it/s] Epoch 40: lr=0.000040 train_loss=0.0216 train_acc=0.9940 val_acc=0.9940 Train 41/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.60it/s] Epoch 41: lr=0.000004 train_loss=0.0216 train_acc=0.9946 val_acc=0.9919 Train 42/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.63it/s] Epoch 42: lr=0.000004 train_loss=0.0214 train_acc=0.9945 val_acc=0.9919 Train 43/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.61it/s] Epoch 43: lr=0.000004 train_loss=0.0210 train_acc=0.9950 val_acc=0.9950 Train 44/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.70it/s] Epoch 44: lr=0.000004 train_loss=0.0245 train_acc=0.9940 val_acc=0.9919 Train 45/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.62it/s] Epoch 45: lr=0.000004 train_loss=0.0205 train_acc=0.9947 val_acc=0.9919 Train 46/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.20it/s] Epoch 46: lr=0.000004 train_loss=0.0196 train_acc=0.9958 val_acc=0.9940 Train 47/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.62it/s] Epoch 47: lr=0.000004 train_loss=0.0218 train_acc=0.9941 val_acc=0.9940 Train 48/60: 100%|██████████████████████████████████████| 249/249 [00:32<00:00, 7.55it/s] Epoch 48: lr=0.000004 train_loss=0.0214 train_acc=0.9948 val_acc=0.9950 Train 49/60: 100%|██████████████████████████████████████| 249/249 [00:34<00:00, 7.32it/s] Epoch 49: lr=0.000004 train_loss=0.0169 train_acc=0.9958 val_acc=0.9950 Train 50/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.50it/s] Epoch 50: lr=0.000004 train_loss=0.0231 train_acc=0.9935 val_acc=0.9940 Train 51/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.49it/s] Epoch 51: lr=0.000004 train_loss=0.0225 train_acc=0.9941 val_acc=0.9919 Train 52/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.41it/s] Epoch 52: lr=0.000004 train_loss=0.0189 train_acc=0.9947 val_acc=0.9950 Train 53/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.45it/s] Epoch 53: lr=0.000004 train_loss=0.0196 train_acc=0.9950 val_acc=0.9930 Train 54/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.46it/s] Epoch 54: lr=0.000004 train_loss=0.0227 train_acc=0.9940 val_acc=0.9940 Train 55/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.44it/s] Epoch 55: lr=0.000004 train_loss=0.0203 train_acc=0.9948 val_acc=0.9940 Train 56/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.46it/s] Epoch 56: lr=0.000004 train_loss=0.0210 train_acc=0.9936 val_acc=0.9930 Train 57/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.46it/s] Epoch 57: lr=0.000004 train_loss=0.0187 train_acc=0.9951 val_acc=0.9930 Train 58/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.40it/s] Epoch 58: lr=0.000004 train_loss=0.0204 train_acc=0.9946 val_acc=0.9940 Train 59/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.45it/s] Epoch 59: lr=0.000004 train_loss=0.0186 train_acc=0.9945 val_acc=0.9940 Train 60/60: 100%|██████████████████████████████████████| 249/249 [00:33<00:00, 7.46it/s] Epoch 60: lr=0.000004 train_loss=0.0182 train_acc=0.9960 val_acc=0.9940 Training done. Best val_acc: 0.9949647532729103 (.venv)
"""

# Improved regex
pattern = re.compile(
    r"Epoch\s+(\d+):.*?train_acc=([0-9.]+).*?val_acc=([0-9.]+)"
)

epochs = []
train_acc = []
val_acc = []

for match in pattern.finditer(log_text):
    epochs.append(int(match.group(1)))
    train_acc.append(float(match.group(2)))
    val_acc.append(float(match.group(3)))

print("Parsed epochs:", len(epochs))

if len(epochs) == 0:
    raise ValueError("Still no epochs found. Check paste formatting.")

Path("results").mkdir(exist_ok=True)

plt.figure(figsize=(8,5))
plt.plot(epochs, train_acc, label="Train Accuracy")
plt.plot(epochs, val_acc, label="Validation Accuracy")
plt.xlabel("Epoch")
plt.ylabel("Accuracy")
plt.title("Training vs Validation Accuracy")
plt.legend()
plt.grid(True, alpha=0.3)

plt.savefig("results/train_val_accuracy.png", dpi=300, bbox_inches="tight")
print("Saved: results/train_val_accuracy.png")


